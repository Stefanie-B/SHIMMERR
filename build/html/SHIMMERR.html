<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SHIMMERR package &#8212; SHIMMERR v1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5cb08e4e"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SHIMMERR" href="modules.html" />
    <link rel="prev" title="SHIMMERR documentation" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="shimmerr-package">
<h1>SHIMMERR package<a class="headerlink" href="#shimmerr-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-SHIMMERR.array">
<span id="shimmerr-array-module"></span><h2>SHIMMERR.array module<a class="headerlink" href="#module-SHIMMERR.array" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="SHIMMERR.array.Antenna">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SHIMMERR.array.</span></span><span class="sig-name descname"><span class="pre">Antenna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">0j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Antenna" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that represents the lowest level elements in the array.</p>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>p: list</dt><dd><p>Contains the 3D position of the antenna in ECEF (Earth-Centered Earth-Fixed) coordinates</p>
</dd>
<dt>p_ENU: list</dt><dd><p>Contains the 3D position of the antenna in ENU (East-North-Up) coordinates</p>
</dd>
<dt>g: complex</dt><dd><p>Complex gain of the element</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Antenna.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">0j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Antenna.__init__" title="Link to this definition">¶</a></dt>
<dd><section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>position<span class="classifier">list</span></dt><dd><p>Contains the 3D position of the antenna in ETRS coordinates</p>
</dd>
<dt>gain<span class="classifier">complex, optional</span></dt><dd><p>Complex gain of the element, by default 1</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Antenna.calculate_response">
<span class="sig-name descname"><span class="pre">calculate_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'omnidirectional'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Antenna.calculate_response" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the element response in directions.</p>
<section id="id1">
<h4>Parameters<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>directions<span class="classifier">ndarray</span></dt><dd><p>3xM array of unit length vectors that decribe the directions in ENU coordinates</p>
</dd>
<dt>frequency<span class="classifier">float</span></dt><dd><p>Frequency of the measurement</p>
</dd>
<dt>mode<span class="classifier">str, optional</span></dt><dd><p>sets the beam shape, by default “omnidirectional” (no directivity).</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>M length response</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Antenna.update_antenna">
<span class="sig-name descname"><span class="pre">update_antenna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Antenna.update_antenna" title="Link to this definition">¶</a></dt>
<dd><p>Updates antenna gain</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SHIMMERR.array.Station">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SHIMMERR.array.</span></span><span class="sig-name descname"><span class="pre">Station</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">0j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that represents the full station.</p>
<section id="id2">
<h3>Attributes<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>p: list</dt><dd><p>Contains the 3D position of the station in ECEF (Earth-Centered Earth-Fixed) coordinates</p>
</dd>
<dt>p_array: list</dt><dd><p>Contains the 3D position of the station in ENU (East-North-Up) coordinates of a specified reference stataion</p>
</dd>
<dt>g: complex</dt><dd><p>Complex gain of the element</p>
</dd>
<dt>d: ndarray</dt><dd><p>Complex pointing of the station (in Ra, Dec)</p>
</dd>
<dt>tracking: bool</dt><dd><p>If set, the telescope is in tracking mode (pointed to a specific point), if False, the telescope is in drift-scan mode</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.ENU_rotation_matrix">
<span class="sig-name descname"><span class="pre">ENU_rotation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.ENU_rotation_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the 3x3 matrix that transforms the coordinates from ECEF (Earth-Centered Earth-Fixed) to ENU (East-North-Up)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">0j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.__init__" title="Link to this definition">¶</a></dt>
<dd><section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>positions<span class="classifier">list</span></dt><dd><p>Contains the 3D position of the elements (tiles) in ECEF (Earth-Centered Earth-Fixed) coordinates</p>
</dd>
<dt>pointing_ra<span class="classifier">float, optional</span></dt><dd><p>Right ascension of the phase center in deg, default is None</p>
</dd>
<dt>pointing_dec<span class="classifier">float, optional</span></dt><dd><p>Declination of the phase center in deg, default is None</p>
</dd>
<dt>gain<span class="classifier">complex, optional</span></dt><dd><p>Complex gain of the tile (shared by all elements), by default 1</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.add_random_gain_drift">
<span class="sig-name descname"><span class="pre">add_random_gain_drift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_tile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_antenna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.add_random_gain_drift" title="Link to this definition">¶</a></dt>
<dd><p>Add complex Gaussian zero mean noise to the gains.</p>
<section id="id4">
<h4>Parameters<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>sigma_tile<span class="classifier">float</span></dt><dd><p>Standard deviation of the noise added on a tile level</p>
</dd>
<dt>sigma_antenna<span class="classifier">float</span></dt><dd><p>Standard deviation of the noise added on an antenna level</p>
</dd>
<dt>seed<span class="classifier">None or int, optional</span></dt><dd><p>Seed of the random generator. Set by an integer for reproducability, by default None</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.break_elements">
<span class="sig-name descname"><span class="pre">break_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maximum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.break_elements" title="Link to this definition">¶</a></dt>
<dd><p>Breaks elements within the tiles of the array (by setting their gains to 0). Set the seed for reproducability, but be aware that a different seed should be used for different stations to guarantee randomness.</p>
<section id="id5">
<h4>Parameters<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>mode<span class="classifier">str, optional</span></dt><dd><p>Sets the way in which elements are broken, by default “maximum”
maximum: Uniformly breaks elements up to a maximum number. If higher than the number of elements per tile, the full tile will be flagged more often (numbers between #elements and max are shifted to max)
number: Breaks the specified number of elements. If higher than the number of antennas in a tile, all antennas are broken. Rounds to nearest number of elements per tile (so 10% of 16 elements = 1.6 elements –&gt; 2 elements flagged in every tile)
percentage: Same as number but with a percentage.
typical: Breaks elements according to a normal(number, number) distribution, such that on average &lt;number&gt; elements are broken.
typical_percentage: the same as above but with a percentage.</p>
</dd>
<dt>number<span class="classifier">int, optional</span></dt><dd><p>Number that controls how many elements are broken (so maximum, percentage, etc.), by default 0</p>
</dd>
<dt>seed<span class="classifier">int, optional</span></dt><dd><p>seed for the random number generator that controls how many and which elements are broken, by default None (initialize randomly every call)</p>
</dd>
</dl>
</section>
<section id="raises">
<h4>Raises<a class="headerlink" href="#raises" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>either for a negative number of elements (not physically possible) or for an unknown mode</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.calculate_array_factor">
<span class="sig-name descname"><span class="pre">calculate_array_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_beams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.calculate_array_factor" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the station array factor in M directions.</p>
<section id="id6">
<h4>Parameters<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>directions<span class="classifier">ndarray</span></dt><dd><p>3xM array of unit length vectors that decribe the directions in ENU coordinates</p>
</dd>
<dt>frequency<span class="classifier">float</span></dt><dd><p>Frequency of the measurement</p>
</dd>
<dt>tile_beams<span class="classifier">None or ndarray, optional</span></dt><dd><p>If set to None (default) this disables the element beams and only the array factor is returned. Otherwise, give an N x M array of element responses in the requested directions</p>
</dd>
<dt>pointing_directions<span class="classifier">ndarray</span></dt><dd><p>3xM array of unit length vectors that decribe the direction of the pointing center in ENU coordinates.</p>
</dd>
</dl>
</section>
<section id="id7">
<h4>Returns<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>M length response</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.calculate_response">
<span class="sig-name descname"><span class="pre">calculate_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_all_tiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.calculate_response" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the full station beam in M directions.</p>
<section id="id8">
<h4>Parameters<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>directions<span class="classifier">ndarray</span></dt><dd><p>3xM array of unit length vectors that decribe the directions in ENU coordinates</p>
</dd>
<dt>frequency<span class="classifier">float</span></dt><dd><p>Frequency of the measurement</p>
</dd>
<dt>antenna_mode<span class="classifier">None or str, optional</span></dt><dd><p>If set to None (default) this disables the element beams and only the array factor is returned. Otherwise, give the requested antenna type.</p>
</dd>
<dt>pointing_directions<span class="classifier">ndarray, optional</span></dt><dd><p>3xM array of unit length vectors that decribe the direction of the pointing center in ENU coordinates. Default is None (drift-scan)</p>
</dd>
<dt>calculate_all_tiles<span class="classifier">bool, optional</span></dt><dd><p>If set, all tile beams are computed separately (allows for antenna drift), if unset, a tile beam pattern is reused for all tiles. Default is False.</p>
</dd>
</dl>
</section>
<section id="id9">
<h4>Returns<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>M length response</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.get_element_property">
<span class="sig-name descname"><span class="pre">get_element_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.get_element_property" title="Link to this definition">¶</a></dt>
<dd><p>Helper function for the element list. Retrieves a property of the underlying elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.radec_to_ENU">
<span class="sig-name descname"><span class="pre">radec_to_ENU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_ascension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declination</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporal_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_timesteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.radec_to_ENU" title="Link to this definition">¶</a></dt>
<dd><p>Calculates a sky direction in the stations ENU frame at a given time</p>
<section id="id10">
<h4>Parameters<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>time<span class="classifier">str</span></dt><dd><p>Start time of observation in UTC format (YYYY-MM-DDThh:mm:ss, example: 2024-07-04T19:25:00)</p>
</dd>
<dt>right_ascension<span class="classifier">float, optional</span></dt><dd><p>RA in deg, default is None (for if the phase center is observed)</p>
</dd>
<dt>declination<span class="classifier">float, optional</span></dt><dd><p>dec in deg, default is None (for if the phase center is observed)</p>
</dd>
<dt>temporal_offset<span class="classifier">float</span></dt><dd><p>Time resolution in s.</p>
</dd>
<dt>number_of_timesteps<span class="classifier">int</span></dt><dd><p>Number of simulated time intervals, default is 1</p>
</dd>
<dt>tracking_direction<span class="classifier">bool</span></dt><dd><p>If set, compute the direction of the phase center instead of the Ra,Dec. Default is False.</p>
</dd>
</dl>
</section>
<section id="id11">
<h4>Returns<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>source direction unit vector in ENU</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.reset_elements">
<span class="sig-name descname"><span class="pre">reset_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.reset_elements" title="Link to this definition">¶</a></dt>
<dd><p>Resets all elements in the tile to the common pointing and unit gain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.set_ENU_positions">
<span class="sig-name descname"><span class="pre">set_ENU_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.set_ENU_positions" title="Link to this definition">¶</a></dt>
<dd><p>Sets ENU (East-North-Up) coordinates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.set_array_position">
<span class="sig-name descname"><span class="pre">set_array_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.set_array_position" title="Link to this definition">¶</a></dt>
<dd><p>Sets position of station within the interferometric array compared to another station (so the position is the ENU position of self in the reference frame of the other station)</p>
<section id="id12">
<h4>Parameters<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>station<span class="classifier">Station object</span></dt><dd><p>reference station</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.set_element_property">
<span class="sig-name descname"><span class="pre">set_element_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.set_element_property" title="Link to this definition">¶</a></dt>
<dd><p>Helper function for the element list. Sets a property of the underlying elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Station.update_station_pointing">
<span class="sig-name descname"><span class="pre">update_station_pointing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_pointing_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_pointing_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Station.update_station_pointing" title="Link to this definition">¶</a></dt>
<dd><p>Updates station_pointing (including tile pointing). If the pointing is set to None, the telescope operates in drift-scan mode.</p>
<section id="id13">
<h4>Parameters<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>pointing_ra<span class="classifier">float, optional</span></dt><dd><p>Right ascension of the phase center in deg, default is None</p>
</dd>
<dt>pointing_dec<span class="classifier">float, optional</span></dt><dd><p>Declination of the phase center in deg, default is None</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SHIMMERR.array.</span></span><span class="sig-name descname"><span class="pre">Tile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">0j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that represents the analogue beamformer elements in the array.</p>
<section id="id14">
<h3>Attributes<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>p: list</dt><dd><p>Contains the 3D position of the tile in ECEF (Earth-Centered Earth-Fixed) coordinates</p>
</dd>
<dt>p_ENU: list</dt><dd><p>Contains the 3D position of the tile in ENU (East-North-Up) coordinates</p>
</dd>
<dt>g: complex</dt><dd><p>Complex gain of the element</p>
</dd>
<dt>d: ndarray</dt><dd><p>Complex pointing of the tile (in Ra, Dec)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracking</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">0j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile.__init__" title="Link to this definition">¶</a></dt>
<dd><section id="id15">
<h4>Parameters<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>positions<span class="classifier">list</span></dt><dd><p>Contains the 3D position of the elements in ECEF coordinates</p>
</dd>
<dt>pointing<span class="classifier">complex, optional</span></dt><dd><p>Complex pointing of the tile (in ENU coordinates)</p>
</dd>
<dt>gain<span class="classifier">complex, optional</span></dt><dd><p>Complex gain of the tile (shared by all elements), by default 1</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile.calculate_response">
<span class="sig-name descname"><span class="pre">calculate_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_beams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_directions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile.calculate_response" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates the tile response or array factor in M directions.</p>
<dl class="simple">
<dt>directions<span class="classifier">ndarray</span></dt><dd><p>3xM array of unit length vectors that decribe the directions in ENU coordinates</p>
</dd>
<dt>frequency<span class="classifier">float</span></dt><dd><p>Frequency of the measurement</p>
</dd>
<dt>antenna_beams<span class="classifier">None or ndarray, optional</span></dt><dd><p>If set to None (default) this disables the element beams and only the array factor is returned. Otherwise, give an N x M array of element responses in the requested directions</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>pointing_directions<span class="classifier">ndarray, optional</span></dt><dd><blockquote>
<div><p>3xM array of unit length vectors that decribe the direction of the pointing center in ENU coordinates. Default is None (drift-scan)</p>
</div></blockquote>
<dl class="simple">
<dt>ndarray</dt><dd><p>M length response</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile.get_element_property">
<span class="sig-name descname"><span class="pre">get_element_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile.get_element_property" title="Link to this definition">¶</a></dt>
<dd><p>Helper function for the element list. Retrieves a property of the underlying elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile.reset_elements">
<span class="sig-name descname"><span class="pre">reset_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile.reset_elements" title="Link to this definition">¶</a></dt>
<dd><p>Resets all elements in the tile to have unit gain</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile.set_ENU_positions">
<span class="sig-name descname"><span class="pre">set_ENU_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotation_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_position</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile.set_ENU_positions" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the ENU (East-North-Up) coordinates of all elements and the tile itself, based on the station rotation matrix from ECEF to ENU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile.set_element_property">
<span class="sig-name descname"><span class="pre">set_element_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">same_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile.set_element_property" title="Link to this definition">¶</a></dt>
<dd><p>Helper function for the element list. Sets a property of the underlying elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.array.Tile.update_tile_gain">
<span class="sig-name descname"><span class="pre">update_tile_gain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_gain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.Tile.update_tile_gain" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.array.calculate_array_factor_contribution">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.array.</span></span><span class="sig-name descname"><span class="pre">calculate_array_factor_contribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.array.calculate_array_factor_contribution" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the array factor contributions of all elements and passes them separately (not summed).</p>
<section id="id16">
<h3>Parameters<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>positions<span class="classifier">ndarray</span></dt><dd><p>3xN array of element positions (must be floats)</p>
</dd>
<dt>gains<span class="classifier">ndarray</span></dt><dd><p>N sized array of element gains (must be complex)</p>
</dd>
<dt>k<span class="classifier">float</span></dt><dd><p>wave number</p>
</dd>
<dt>directions<span class="classifier">ndarray</span></dt><dd><p>3xM array of directions to calculate the response in</p>
</dd>
</dl>
</section>
<section id="id17">
<h3>Returns<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>ndarray</dt><dd><p>N x M array with responses</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-SHIMMERR.calibration">
<span id="shimmerr-calibration-module"></span><h2>SHIMMERR.calibration module<a class="headerlink" href="#module-SHIMMERR.calibration" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="SHIMMERR.calibration.DDEcal">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SHIMMERR.calibration.</span></span><span class="sig-name descname"><span class="pre">DDEcal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_lambda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[250,</span> <span class="pre">5000]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'omnidirectional'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_speed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothness_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.calibration.DDEcal" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that can run DDECal in a single polarisation, with various weighting schemes.</p>
<section id="id18">
<h3>Attributes:<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>array: dict</dt><dd><p>Interferometer dictionary with Station objects as values.</p>
</dd>
<dt>reference_station: str</dt><dd><p>Name (AKA array key) of the station that should act as the reference for gain phases. Subtracting the phases of this station removes unitairy ambiguity.</p>
</dd>
<dt>n_channels: int</dt><dd><p>Number of channels per solution interval</p>
</dd>
<dt>n_times: int</dt><dd><p>Number of time steps per solution interval</p>
</dd>
<dt>uv_lambda: list</dt><dd><p>List containing the minimum and maximum baseline length used in calibration in lambda.</p>
</dd>
<dt>antenna_mode: str</dt><dd><p>Mode for the antenna in the calibration beam (see: Antenna objects).</p>
</dd>
<dt>n_iterations: int</dt><dd><p>Number of iterations for the algorithm.</p>
</dd>
<dt>tolerance: float</dt><dd><p>If the mean change rate of the gains drops below this number, the algorithm interprets it as convergence and stops the optimisation earlier than n_iterations.</p>
</dd>
<dt>update_spead: float</dt><dd><p>Number between 0 and 1 that determines how quick the gain solutions should update. A speed of 0 means no update, a speed of 1 means that the previous gain solution is not included in the update.</p>
</dd>
<dt>smoothness_scale: float</dt><dd><p>Width of the spectral regularisation kernel in MHz.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.calibration.DDEcal.calculate_residuals">
<span class="sig-name descname"><span class="pre">calculate_residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">visibility_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skymodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.calibration.DDEcal.calculate_residuals" title="Link to this definition">¶</a></dt>
<dd><p>Calculate residuals with known gains</p>
<section id="id19">
<h4>Parameters<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>visibility_file<span class="classifier">str</span></dt><dd><p>filename that contains the visibilities (path + name).</p>
</dd>
<dt>gain_path<span class="classifier">str</span></dt><dd><p>path + filename of the gains</p>
</dd>
<dt>skymodel<span class="classifier">Skymodel object</span></dt><dd><p>Used for determining the calibration directions, see sources.py</p>
</dd>
<dt>fname<span class="classifier">str</span></dt><dd><p>output file name (including path)</p>
</dd>
<dt>data_path<span class="classifier">str, optional</span></dt><dd><p>basepath for the model and gains, by default None (inferred from the visibility file)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.calibration.DDEcal.run_DDEcal">
<span class="sig-name descname"><span class="pre">run_DDEcal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">visibility_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skymodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_predict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reweight_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.calibration.DDEcal.run_DDEcal" title="Link to this definition">¶</a></dt>
<dd><p>Perform DDECal</p>
<section id="id20">
<h4>Parameters<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>visibility_file<span class="classifier">str</span></dt><dd><p>filename that contains the visibilities (path + name)</p>
</dd>
<dt>skymodel<span class="classifier">Skymodel object</span></dt><dd><p>sources. Used for determining the calibration directions and possibly the predict, see sources.py</p>
</dd>
<dt>reuse_predict<span class="classifier">bool, optional</span></dt><dd><p>If True, the coherency model is read from disk, if False it is computed first, by default False</p>
</dd>
<dt>reweight_mode<span class="classifier">str, optional</span></dt><dd><p>Reweighting kernel (“abs”, “squared” or None), by default None
- abs: robust calibrator (smooth with the expected beam response)
- squared: smooth with the square of the model times gain
- None: smooth with the gain</p>
</dd>
<dt>fname<span class="classifier">str, optional</span></dt><dd><p>Name of the output files. By default None (name is set to Calibration_&lt;reweight_mode&gt;_&lt;smoothness_scale&gt;).</p>
</dd>
<dt>calculate_residual<span class="classifier">bool, optional</span></dt><dd><p>Whether to also calculate the residual visibilities, by default True</p>
</dd>
<dt>data_path<span class="classifier">str, optional</span></dt><dd><p>basepath for the model and output, by default None (inferred from the visibility file)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-SHIMMERR.export">
<span id="shimmerr-export-module"></span><h2>SHIMMERR.export module<a class="headerlink" href="#module-SHIMMERR.export" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.export.export_MS">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.export.</span></span><span class="sig-name descname"><span class="pre">export_MS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visibility_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/codex/brackenhoff/projects/beam_errors/beam_errors/files/LOFAR_HBA_Dutch_template.MS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DP3_binding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DP3'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.export.export_MS" title="Link to this definition">¶</a></dt>
<dd><p>Function that converts visbility CSVs from SHIMMERR into MS.</p>
<section id="id21">
<h3>Parameters<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>array<span class="classifier">dict</span></dt><dd><p>dictionary of Station objects that form the interferometer</p>
</dd>
<dt>visibility_file<span class="classifier">str</span></dt><dd><p>path + filename of the csv with the stored visibilities</p>
</dd>
<dt>output_file<span class="classifier">str</span></dt><dd><p>path + filename of the MS in which the visibilities should be output</p>
</dd>
<dt>template_name<span class="classifier">str, optional</span></dt><dd><p>path + filename of the MS template. Currently SHIMMERR is only packages with LOFAR HBA, but another template van be supplied by the user. This will change the ELEMENT_FLAGGING, however, (see the _unflag_broken_tiles function), by default f”&lt;SHIMMERR home directory&gt;/files/LOFAR_HBA_Dutch_template.MS”</p>
</dd>
<dt>DP3_binding<span class="classifier">str, optional</span></dt><dd><p>binding to call DP3 from (for example if it should be called with a container), by default “DP3”</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-SHIMMERR.load_array">
<span id="shimmerr-load-array-module"></span><h2>SHIMMERR.load_array module<a class="headerlink" href="#module-SHIMMERR.load_array" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.load_array.load_LOFAR">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.load_array.</span></span><span class="sig-name descname"><span class="pre">load_LOFAR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EoR'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.load_array.load_LOFAR" title="Link to this definition">¶</a></dt>
<dd><p>Loads LOFAR HBA using coordinates from Michiel Brentjens’ LOFAR Antpos: <a class="reference external" href="https://github.com/brentjens/lofar-antenna-positions">https://github.com/brentjens/lofar-antenna-positions</a></p>
<section id="id22">
<h3>Parameters<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>mode<span class="classifier">str, optional</span></dt><dd><p>Beamforming mode, can be “CS” (only core stations), “Dutch tapered” (all Dutch stations, with the RS beamformed to act like a CS), “Dutch sensitive” (all Dutch stations, with all tiles in the RS functioning), “international” (all LOFAR stations from Lofarantpos), or “EoR” (stations with baselines shorter than ~10 km, in tapered setting, corresponds to the Epoch of Reionization science case), by default “EoR”</p>
</dd>
<dt>pointing_ra<span class="classifier">float, optional</span></dt><dd><p>Right ascension of the phase center in deg, by default None (drift-scan)</p>
</dd>
<dt>pointing_dec<span class="classifier">float, optional</span></dt><dd><p>Declination of the phase center in deg, by default None (drift-scan)</p>
</dd>
</dl>
</section>
<section id="id23">
<h3>Returns<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>dict</dt><dd><p>Dictionary of SHIMMERR Station objects</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.load_array.load_array_from_file">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.load_array.</span></span><span class="sig-name descname"><span class="pre">load_array_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointing_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.load_array.load_array_from_file" title="Link to this definition">¶</a></dt>
<dd><p>Loads an array from a file supplied by the user. The file should be structured as follows:
- Stations are separated by empty lines, and start with a name (so the first line of the station “paragraph” is a string with its name)
- The rest of the block of a station consists of lines with 4 comma separated values.
– The first is a tile identifier (any string)
– The later 3 are antenna positions in ETRS coordinates
– New tiles are automatically created when a new tile identifier is read
Comments can be added with a # sign at the start of a line</p>
<section id="id24">
<h3>Parameters<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>filepath<span class="classifier">str</span></dt><dd><p>path + filename of the file that contains the array.</p>
</dd>
<dt>pointing_ra<span class="classifier">float, optional</span></dt><dd><p>Right ascension of the phase center in deg, by default None (drift-scan)</p>
</dd>
<dt>pointing_dec<span class="classifier">float, optional</span></dt><dd><p>Declination of the phase center in deg, by default None (drift-scan)</p>
</dd>
</dl>
</section>
<section id="id25">
<h3>Returns<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>dict</dt><dd><p>Dictionary of SHIMMERR Station objects</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-SHIMMERR.metrics">
<span id="shimmerr-metrics-module"></span><h2>SHIMMERR.metrics module<a class="headerlink" href="#module-SHIMMERR.metrics" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.metrics.compute_realized_gains">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.metrics.</span></span><span class="sig-name descname"><span class="pre">compute_realized_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory_realized_responses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory_ideal_responses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_realized_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.metrics.compute_realized_gains" title="Link to this definition">¶</a></dt>
<dd><p>Computes the “realised gains”, AKA the ratio between the true beam response and the calibration beam response. This is the “perfect” gain that perfectly calibrates a calibration patch. In reality, this gain can’t come out of calibration (solution intervals, noise, etc.), but it can be used to gauge gain calirbation errors
NB: be careful that this uses beam _responses_ (one station) not the beam _models_ (baseline-based).</p>
<section id="id26">
<h3>Parameters<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>directory_realized_responses<span class="classifier">str</span></dt><dd><p>Path of the directory with true beam responses</p>
</dd>
<dt>directory_ideal_responses<span class="classifier">str</span></dt><dd><p>Path of the directory with the calibration beam responses</p>
</dd>
<dt>fname_realized_gains<span class="classifier">str</span></dt><dd><p>filename to save the realized gains under</p>
</dd>
<dt>patch_names<span class="classifier">list, optional</span></dt><dd><p>list of strings with the names of the calibration directions in which the responses should be computed, by default None (uses all patches in the directory).</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-SHIMMERR.sources">
<span id="shimmerr-sources-module"></span><h2>SHIMMERR.sources module<a class="headerlink" href="#module-SHIMMERR.sources" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="SHIMMERR.sources.Patch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SHIMMERR.sources.</span></span><span class="sig-name descname"><span class="pre">Patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_declination</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Patch" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Patch.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_declination</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Patch.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Class that contains a calibration patch (group/cluster of sources)</p>
<section id="id27">
<h3>Parameters<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>patch_right_ascension<span class="classifier">str</span></dt><dd><p>RA in HH:MM:SS.SSS</p>
</dd>
<dt>patch_declination<span class="classifier">str</span></dt><dd><p>Dec in +-DD.MM.SS.SSS</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Patch.add_source">
<span class="sig-name descname"><span class="pre">add_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logSI</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Patch.add_source" title="Link to this definition">¶</a></dt>
<dd><p>Creates a source within the Patch. The brightness is computed as for a LOFAR sourcedb (see <a class="reference external" href="https://www.astron.nl/lofarwiki/doku.php?id=public:user_software:documentation:makesourcedb">https://www.astron.nl/lofarwiki/doku.php?id=public:user_software:documentation:makesourcedb</a>)</p>
<section id="id28">
<h3>Parameters<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>right_ascension<span class="classifier">str</span></dt><dd><p>RA in HH:MM:SS.SSS</p>
</dd>
<dt>declination<span class="classifier">str</span></dt><dd><p>Dec in +-DD.MM.SS.SSS</p>
</dd>
<dt>brightness<span class="classifier">float</span></dt><dd><p>Source brightness (I0)</p>
</dd>
<dt>reference_frequency<span class="classifier">float</span></dt><dd><p>v0</p>
</dd>
<dt>spectral_index<span class="classifier">str</span></dt><dd><p>str in the form [c0,c1,c2]</p>
</dd>
<dt>logSI<span class="classifier">bool</span></dt><dd><p>whether the spectral index is logarithmic</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SHIMMERR.sources.Skymodel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SHIMMERR.sources.</span></span><span class="sig-name descname"><span class="pre">Skymodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Skymodel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Skymodel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Skymodel.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Reads a skymodel from disk and converts it into a SHIMMERR sky model.</p>
<section id="id29">
<h3>Parameters<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>path + filename of the sky model</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Skymodel.join_patches">
<span class="sig-name descname"><span class="pre">join_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint_dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Skymodel.join_patches" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Skymodel.parse_formatstring">
<span class="sig-name descname"><span class="pre">parse_formatstring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Skymodel.parse_formatstring" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SHIMMERR.sources.Source">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SHIMMERR.sources.</span></span><span class="sig-name descname"><span class="pre">Source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logSI</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Source" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Source.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logSI</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Source.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Class to describe a sky-model source. The brightness is computed as for a LOFAR sourcedb (see <a class="reference external" href="https://www.astron.nl/lofarwiki/doku.php?id=public:user_software:documentation:makesourcedb">https://www.astron.nl/lofarwiki/doku.php?id=public:user_software:documentation:makesourcedb</a>)</p>
<section id="id30">
<h3>Parameters<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>right_ascension<span class="classifier">str</span></dt><dd><p>RA in HH:MM:SS.SSS</p>
</dd>
<dt>declination<span class="classifier">str</span></dt><dd><p>Dec in +-DD.MM.SS.SSS</p>
</dd>
<dt>brightness<span class="classifier">float</span></dt><dd><p>Source brightness (I0)</p>
</dd>
<dt>reference_frequency<span class="classifier">float</span></dt><dd><p>v0</p>
</dd>
<dt>spectral_index<span class="classifier">str</span></dt><dd><p>str in the form [c0,c1,c2]</p>
</dd>
<dt>logSI<span class="classifier">bool</span></dt><dd><p>whether the spectral index is logarithmic</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Source.linear_spectral_index_brightness">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">linear_spectral_index_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Source.linear_spectral_index_brightness" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to calculate the brightness as a function of frequency for a linear spectral index</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Source.logarithmic_spectral_index_brightness">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logarithmic_spectral_index_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Source.logarithmic_spectral_index_brightness" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to calculate the brightness as a function of frequency for a logarithmic spectral index</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Source.parse_declination">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_declination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">declination_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Source.parse_declination" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to convert the Dec to degrees</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SHIMMERR.sources.Source.parse_right_ascension">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_right_ascension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right_ascension_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.sources.Source.parse_right_ascension" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to convert the RA to degrees</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-SHIMMERR.visibility">
<span id="shimmerr-visibility-module"></span><h2>SHIMMERR.visibility module<a class="headerlink" href="#module-SHIMMERR.visibility" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.add_thermal_noise">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">add_thermal_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sefd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.add_thermal_noise" title="Link to this definition">¶</a></dt>
<dd><p>Adds thermal noise to the visibilities</p>
<section id="id31">
<h3>Parameters<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>directory of the relevant visibilities. The input file with be at &lt;path&gt;/&lt;filename&gt;/full_model.csv, and the output file at &lt;path&gt;/&lt;filename&gt;/data.csv</p>
</dd>
<dt>data_path<span class="classifier">str</span></dt><dd><p>data path (see filename)</p>
</dd>
<dt>sefd<span class="classifier">float</span></dt><dd><p>system equivalent flux density of the noise</p>
</dd>
<dt>seed<span class="classifier">int</span></dt><dd><p>seed for the randum number generator</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.calculate_directions">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">calculate_directions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time_utc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_timeslots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_ascensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declinations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.calculate_directions" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to generate source directions and tracking directions in an easy format</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.get_time_labels">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">get_time_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_time_utc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.get_time_labels" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to generate time labels for the visibilities</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.predict_data">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">predict_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skymodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time_utc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./data/predictions'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'omnidirectional'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basestation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_tile_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SEFD</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.predict_data" title="Link to this definition">¶</a></dt>
<dd><p>Performs a full visibility predict from a sky model and interferometer.</p>
<section id="id32">
<h3>Parameters<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>array<span class="classifier">dict</span></dt><dd><p>dict of SHIMMERR stations that describe the interferometer (see array.py and load_array.py)</p>
</dd>
<dt>skymodel<span class="classifier">dict</span></dt><dd><p>dict of SHIMMERR patches that describe the sources in the sky (see sources.py)</p>
</dd>
<dt>frequencies<span class="classifier">list or ndarray of floats</span></dt><dd><p>Frequencies at which to simulate the array. We simulate no smearing etc.</p>
</dd>
<dt>start_time_utc<span class="classifier">str</span></dt><dd><p>UTC start time of the observation in format YYYY-MM-DDThh:mm:ss, example: 2024-07-04T19:25:00</p>
</dd>
<dt>filename<span class="classifier">str</span></dt><dd><p>name of the folder in which the visibilities should be saved</p>
</dd>
<dt>data_path<span class="classifier">str, optional</span></dt><dd><p>folder in which the destination folder should be saved, by default “./data/predictions”</p>
</dd>
<dt>time_resolution<span class="classifier">int, optional</span></dt><dd><p>time resolution in seconds, by default 2</p>
</dd>
<dt>duration<span class="classifier">int, optional</span></dt><dd><p>observation duration in hours, by default 12</p>
</dd>
<dt>antenna_mode<span class="classifier">str, optional</span></dt><dd><p>beam mode for the lowest level elements, by default “omnidirectional”</p>
</dd>
<dt>basestation<span class="classifier">str, optional</span></dt><dd><p>name of the station used as the ‘array center’, by default None (selects the first station in the array dictionary)</p>
</dd>
<dt>reuse_tile_beam<span class="classifier">bool, optional</span></dt><dd><p>If set, uses the same tile model for all tiles in a stationm. This does not allow for intra-tile variation, but does speed up the computation. Recommended for the calibration model predict, by default False (all tiles computed separately)</p>
</dd>
<dt>SEFD<span class="classifier">float, optional</span></dt><dd><p>System equivalent flux density of the noise in Jy. Set to None to disable noise, by default 4.2e3</p>
</dd>
<dt>save_response<span class="classifier">bool, optional</span></dt><dd><p>toggles whether the station responses are saved to enable computing the expected gain. Default is True.</p>
</dd>
<dt>seed<span class="classifier">int, optional</span></dt><dd><p>seed for the random number generator that creates the noise, set to anything but None for reproducability, by default None</p>
</dd>
<dt>n_jobs<span class="classifier">int, optional</span></dt><dd><p>Number of prediction processes that are allowed to run in parallel (ideally equal to the number of CPU cores), by default -1 (all cores used)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.predict_patch_visibilities">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">predict_patch_visibilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skymodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time_utc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./data/predictions'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'omnidirectional'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basestation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_tile_beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_response</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.predict_patch_visibilities" title="Link to this definition">¶</a></dt>
<dd><p>Predicts noiseless visibilities of each patch and saves each patch to disk.</p>
<section id="id33">
<h3>Parameters<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>array<span class="classifier">dict</span></dt><dd><p>Dictionary containing Station objects</p>
</dd>
<dt>skymodel<span class="classifier">Skymodel object</span></dt><dd><p>skymodel to be simulated</p>
</dd>
<dt>frequencies<span class="classifier">list or ndarray of floats</span></dt><dd><p>Frequencies at which to simulate the array. We simulate no smearing etc.</p>
</dd>
<dt>start_time_utc<span class="classifier">str</span></dt><dd><p>UTC start time of the observation in format YYYY-MM-DDThh:mm:ss, example: 2024-07-04T19:25:00</p>
</dd>
<dt>filename<span class="classifier">str</span></dt><dd><p>name of the folder in which the visibilities should be saved</p>
</dd>
<dt>data_path<span class="classifier">str, optional</span></dt><dd><p>folder in which the destination folder should be saved, by default “./data/predictions”</p>
</dd>
<dt>time_resolution<span class="classifier">int, optional</span></dt><dd><p>time resolution in seconds, by default 2</p>
</dd>
<dt>duration<span class="classifier">int, optional</span></dt><dd><p>observation duration in hours, by default 12</p>
</dd>
<dt>antenna_mode<span class="classifier">str, optional</span></dt><dd><p>beam mode for the lowest level elements, by default “omnidirectional”</p>
</dd>
<dt>basestation<span class="classifier">str, optional</span></dt><dd><p>name of the station used as the ‘array center’, by default None (selects the first station in the array dictionary)</p>
</dd>
<dt>prediction_batch_size<span class="classifier">int, optional</span></dt><dd><p>approximate batch size for each visibility prediction after beam calculation. This is a trade off between speed and memory virtualization. The batch will become an integer multiple of the number of stations * number of sources, so this number may be exceeded if one of such batches is larger than the specified value, by default 10000.</p>
</dd>
<dt>save_response<span class="classifier">bool, optional</span></dt><dd><p>toggles whether the station responses are saved to enable computing the expected gain. Default is True.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.process_batch">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">process_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_powers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.process_batch" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.record_beams">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">record_beams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.record_beams" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to write the response beam files</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.subtract_visibilities">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">subtract_visibilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_in_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_in_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.subtract_visibilities" title="Link to this definition">¶</a></dt>
<dd><p>Function to take the difference between visibilities (for source subtraction)</p>
<section id="id34">
<h3>Parameters<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>filename_in_1<span class="classifier">str</span></dt><dd><p>filename of the visibilities from which the sources must be subtracted</p>
</dd>
<dt>filename_in_2<span class="classifier">str</span></dt><dd><p>filename of the visibilities with the sources that must be subtracted</p>
</dd>
<dt>filename_out<span class="classifier">str</span></dt><dd><p>filename where the result must be stored</p>
</dd>
<dt>common_path<span class="classifier">str, optional</span></dt><dd><p>path for these files (the paths can also be added to the filename, in which case this would be root), by default “”</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visibility.sum_patches">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visibility.</span></span><span class="sig-name descname"><span class="pre">sum_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skymodel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visibility.sum_patches" title="Link to this definition">¶</a></dt>
<dd><p>Sums all patch models to create a full sky visibility prediction</p>
<section id="id35">
<h3>Parameters<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>directory of the relevant visibilities. The summed file with be at &lt;path&gt;/&lt;filename&gt;/full_model.csv, and the patch models must be at &lt;path&gt;/&lt;filename&gt;/patch_models</p>
</dd>
<dt>data_path<span class="classifier">str</span></dt><dd><p>data path (see filename)</p>
</dd>
<dt>skymodel<span class="classifier">dict</span></dt><dd><p>SHIMMERR sky model (used for patch names only)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-SHIMMERR.visualization">
<span id="shimmerr-visualization-module"></span><h2>SHIMMERR.visualization module<a class="headerlink" href="#module-SHIMMERR.visualization" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visualization.get_beam">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visualization.</span></span><span class="sig-name descname"><span class="pre">get_beam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beam_value_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_plot_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_all_tiles</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visualization.get_beam" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to calculate the beam so it can be plot</p>
<section id="id36">
<h3>Parameters<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>beam_value_mode<span class="classifier">str, optional</span></dt><dd><p>The way in which the beam should be calculated “element”, “tile” (array factor), “station” (array factor), “array_factor” (tile and station array factors combined), or “full” (elements and array factors), by default “full”</p>
</dd>
<dt>beam_plot_mode<span class="classifier">str, optional</span></dt><dd><p>The way in which the beam should be displayed (“power” of “voltage” in dB and real and imaginary in linear scale), by default “power”</p>
</dd>
<dt>station<span class="classifier">Station object</span></dt><dd><p>Station</p>
</dd>
<dt>frequency<span class="classifier">float or int, optional</span></dt><dd><p>measurement frequency to plot the beam for, by default 150e6</p>
</dd>
<dt>directions<span class="classifier">ndarray</span></dt><dd><p>Array with directions in which to calculate the beam, should be 3xNdir</p>
</dd>
<dt>phase_center<span class="classifier">ndarray</span></dt><dd><p>Array with the pointing direction in which to calculate the beam, should be 3xNdir</p>
</dd>
<dt>antenna_mode<span class="classifier">None or str, optional</span></dt><dd><p>Gives the shape of the element beam, by default None</p>
</dd>
<dt>tile_number<span class="classifier">int, optional</span></dt><dd><p>Which tile in the station to display for tile/element option, by default 0</p>
</dd>
<dt>antenna_number<span class="classifier">int, optional</span></dt><dd><p>Which element in the chosen tile to display (for element option), by default 0</p>
</dd>
<dt>calculate_all_tiles<span class="classifier">bool</span></dt><dd><p>If set, all tile beams are computed separately (allows for intra-tile variations), if unset all tile beams are identical (faster computation)</p>
</dd>
</dl>
</section>
<section id="id37">
<h3>Returns<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>ndarray</dt><dd><p>beam values that can be plotted</p>
</dd>
<dt>str</dt><dd><p>colorbar label</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visualization.plot_convergence">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visualization.plot_convergence" title="Link to this definition">¶</a></dt>
<dd><p>Plot the convergence of a calibration run</p>
<section id="id38">
<h3>Parameters<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>results<span class="classifier">dict</span></dt><dd><p>Results as output by the DDECal.run (see calibration.py)</p>
</dd>
<dt>plot_folder<span class="classifier">str</span></dt><dd><p>path where the plot should be save</p>
</dd>
<dt>name<span class="classifier">str</span></dt><dd><p>filename of the plot</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visualization.plot_gain_error">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_gain_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname_true_gains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CS002HBA0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-3.141592653589793,</span> <span class="pre">3.141592653589793]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visualization.plot_gain_error" title="Link to this definition">¶</a></dt>
<dd><p>Creates a plot of the error in estimated gains using the ideal gains (ratio between true beam response and claibration beam)</p>
<section id="id39">
<h3>Parameters<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>fname_gains<span class="classifier">str</span></dt><dd><p>path + filename where the estimated gains are stored</p>
</dd>
<dt>fname_true_gains<span class="classifier">str</span></dt><dd><p>path + filename where the ideal gains are stored (see metrics.py)</p>
</dd>
<dt>plot_folder<span class="classifier">str</span></dt><dd><p>directory where the plot is to be stored</p>
</dd>
<dt>name<span class="classifier">str</span></dt><dd><p>filename of the plot</p>
</dd>
<dt>reference_station<span class="classifier">str, optional</span></dt><dd><p>name fo the reference station used to remove unitairy ambiguity by using it as zero-phase, by default “CS002HBA0”</p>
</dd>
<dt>amplitude_lims<span class="classifier">list, optional</span></dt><dd><p>range of amplitude colorbar, by default [0, 2]</p>
</dd>
<dt>phase_lims<span class="classifier">list, optional</span></dt><dd><p>range of phase colorbar, by default [-np.pi, np.pi]</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visualization.plot_gains">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_gains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-3.141592653589793,</span> <span class="pre">3.141592653589793]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visualization.plot_gains" title="Link to this definition">¶</a></dt>
<dd><p>Function to plot gains</p>
<section id="id40">
<h3>Parameters<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>fname<span class="classifier">str</span></dt><dd><p>path + filename of the results object that contians the gails</p>
</dd>
<dt>plot_folder<span class="classifier">str</span></dt><dd><p>Folder where the plot should be saved</p>
</dd>
<dt>name<span class="classifier">str</span></dt><dd><p>name of the plot</p>
</dd>
<dt>amplitude_lims<span class="classifier">list, optional</span></dt><dd><p>range of the gain amplitude in the plot, by default [0, 2]</p>
</dd>
<dt>phase_lims<span class="classifier">list, optional</span></dt><dd><p>range of the gain phase in the plot, by default [-np.pi, np.pi]</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visualization.plot_spatial_beam">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_spatial_beam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_altitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_plot_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'power'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_value_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_of_interest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2024-01-01T00:00:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_all_tiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visualization.plot_spatial_beam" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to create plots of station beams easily</p>
<section id="id41">
<h3>Parameters<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>station<span class="classifier">Station object</span></dt><dd><p>Station</p>
</dd>
<dt>n_altitude<span class="classifier">int</span></dt><dd><p>Number of points in the altitude sweep (more is higher resolution)</p>
</dd>
<dt>n_azimuth<span class="classifier">int</span></dt><dd><p>Number of points in the azimuth sweep (similar to n_altitude)</p>
</dd>
<dt>frequency<span class="classifier">float or int, optional</span></dt><dd><p>measurement frequency to plot the beam for, by default 150e6</p>
</dd>
<dt>antenna_mode<span class="classifier">None or str, optional</span></dt><dd><p>Gives the shape of the element beam, by default None</p>
</dd>
<dt>beam_plot_mode<span class="classifier">str, optional</span></dt><dd><p>The way in which the beam should be displayed (“power” of “voltage” in dB and real and imaginary in linear scale), by default “power”</p>
</dd>
<dt>beam_value_mode<span class="classifier">str, optional</span></dt><dd><p>The way in which the beam should be calculated “element”, “tile” (array factor), “station” (array factor), “array_factor” (tile and station array factors combined), or “full” (elements and array factors), by default “full”</p>
</dd>
<dt>tile_number<span class="classifier">int, optional</span></dt><dd><p>Which tile in the station to display for tile/element option, by default 0</p>
</dd>
<dt>antenna_number<span class="classifier">int, optional</span></dt><dd><p>Which element in the chosen tile to display (for element option), by default 0</p>
</dd>
<dt>plot_title: str</dt><dd><p>Title of the plot</p>
</dd>
<dt>points_of_interest<span class="classifier">list, optional</span></dt><dd><p>list of directions that should be highlighted in the plot. For example the pointing direction or a bright source, by default [] (no highlighted points)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visualization.plot_spectrotemporal_beam">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_spectrotemporal_beam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_ascension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">declination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([1.34100e+08,</span> <span class="pre">1.34295e+08,</span> <span class="pre">1.34490e+08,</span> <span class="pre">1.34685e+08,</span> <span class="pre">1.34880e+08,</span> <span class="pre">1.35075e+08,</span> <span class="pre">1.35270e+08,</span> <span class="pre">1.35465e+08,</span> <span class="pre">1.35660e+08,</span> <span class="pre">1.35855e+08,</span> <span class="pre">1.36050e+08,</span> <span class="pre">1.36245e+08,</span> <span class="pre">1.36440e+08,</span> <span class="pre">1.36635e+08,</span> <span class="pre">1.36830e+08,</span> <span class="pre">1.37025e+08,</span> <span class="pre">1.37220e+08,</span> <span class="pre">1.37415e+08,</span> <span class="pre">1.37610e+08,</span> <span class="pre">1.37805e+08,</span> <span class="pre">1.38000e+08,</span> <span class="pre">1.38195e+08,</span> <span class="pre">1.38390e+08,</span> <span class="pre">1.38585e+08,</span> <span class="pre">1.38780e+08,</span> <span class="pre">1.38975e+08,</span> <span class="pre">1.39170e+08,</span> <span class="pre">1.39365e+08,</span> <span class="pre">1.39560e+08,</span> <span class="pre">1.39755e+08,</span> <span class="pre">1.39950e+08,</span> <span class="pre">1.40145e+08,</span> <span class="pre">1.40340e+08,</span> <span class="pre">1.40535e+08,</span> <span class="pre">1.40730e+08,</span> <span class="pre">1.40925e+08,</span> <span class="pre">1.41120e+08,</span> <span class="pre">1.41315e+08,</span> <span class="pre">1.41510e+08,</span> <span class="pre">1.41705e+08,</span> <span class="pre">1.41900e+08,</span> <span class="pre">1.42095e+08,</span> <span class="pre">1.42290e+08,</span> <span class="pre">1.42485e+08,</span> <span class="pre">1.42680e+08,</span> <span class="pre">1.42875e+08,</span> <span class="pre">1.43070e+08,</span> <span class="pre">1.43265e+08,</span> <span class="pre">1.43460e+08,</span> <span class="pre">1.43655e+08,</span> <span class="pre">1.43850e+08,</span> <span class="pre">1.44045e+08,</span> <span class="pre">1.44240e+08,</span> <span class="pre">1.44435e+08,</span> <span class="pre">1.44630e+08,</span> <span class="pre">1.44825e+08,</span> <span class="pre">1.45020e+08,</span> <span class="pre">1.45215e+08,</span> <span class="pre">1.45410e+08,</span> <span class="pre">1.45605e+08,</span> <span class="pre">1.45800e+08,</span> <span class="pre">1.45995e+08,</span> <span class="pre">1.46190e+08,</span> <span class="pre">1.46385e+08,</span> <span class="pre">1.46580e+08])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utc_starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2024-07-04T21:35:00'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_timeslots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_plot_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'power'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam_value_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">antenna_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_all_tiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visualization.plot_spectrotemporal_beam" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to create plots of station beams easily</p>
<section id="id42">
<h3>Parameters<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>station<span class="classifier">Station object</span></dt><dd><p>Station</p>
</dd>
<dt>right_ascention<span class="classifier">float</span></dt><dd><p>Target RA in degrees</p>
</dd>
<dt>declination<span class="classifier">float</span></dt><dd><p>Target dec in degrees</p>
</dd>
<dt>frequencies<span class="classifier">ndarray, optional</span></dt><dd><p>channel central frequencies to plot the beam for in Hz. Default is 195kHz channels between 134.1 and 146.7 MHz (LOFAR-EoR redshift bin 2).</p>
</dd>
<dt>utc_starttim<span class="classifier">str</span></dt><dd><p>Observing time in UTC format (YYYY-MM-DDThh:mm:ss. Default is “2024-07-04T21:35:00”</p>
</dd>
<dt>time_resolution<span class="classifier">float</span></dt><dd><p>Time resolution at which to plot the beam in seconds. Default is 2.</p>
</dd>
<dt>number_of_timeslots<span class="classifier">int</span></dt><dd><p>Number of timeslots (of size time_resolution) to plot. Default is 400</p>
</dd>
<dt>antenna_mode<span class="classifier">None or str, optional</span></dt><dd><p>Gives the shape of the element beam, by default None</p>
</dd>
<dt>beam_plot_mode<span class="classifier">str, optional</span></dt><dd><p>The way in which the beam should be displayed (“power” of “voltage” in dB and real and imaginary in linear scale), by default “power”</p>
</dd>
<dt>beam_value_mode<span class="classifier">str, optional</span></dt><dd><p>The way in which the beam should be calculated “element”, “tile” (array factor), “station” (array factor), “array_factor” (tile and station array factors combined), or “full” (elements and array factors), by default “full”</p>
</dd>
<dt>tile_number<span class="classifier">int, optional</span></dt><dd><p>Which tile in the station to display for tile/element option, by default 0</p>
</dd>
<dt>antenna_number<span class="classifier">int, optional</span></dt><dd><p>Which element in the chosen tile to display (for element option), by default 0</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SHIMMERR.visualization.plot_visibility">
<span class="sig-prename descclassname"><span class="pre">SHIMMERR.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_visibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnitude_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-3.141592653589793,</span> <span class="pre">3.141592653589793]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SHIMMERR.visualization.plot_visibility" title="Link to this definition">¶</a></dt>
<dd><p>Plots a visibility</p>
<section id="id43">
<h3>Parameters<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>pth + filename of the visibility</p>
</dd>
<dt>station_pairs<span class="classifier">list</span></dt><dd><p>list of tuples with the baseline to be plotted</p>
</dd>
<dt>magnitude_range<span class="classifier">list, optional</span></dt><dd><p>range of the magnitude scale, by default [None, None]</p>
</dd>
<dt>phase_range<span class="classifier">list, optional</span></dt><dd><p>range of the phase scale, by default [-np.pi, np.pi]</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-SHIMMERR">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-SHIMMERR" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SHIMMERR</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">SHIMMERR package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.array">SHIMMERR.array module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.calibration">SHIMMERR.calibration module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.export">SHIMMERR.export module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.load_array">SHIMMERR.load_array module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.metrics">SHIMMERR.metrics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.sources">SHIMMERR.sources module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.visibility">SHIMMERR.visibility module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR.visualization">SHIMMERR.visualization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-SHIMMERR">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">SHIMMERR</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">SHIMMERR package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">SHIMMERR documentation</a></li>
      <li>Next: <a href="modules.html" title="next chapter">SHIMMERR</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Stefanie A. Brackenhoff.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/SHIMMERR.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>